# Washing-Machine

***상공회의소 AI시스템반도체과정, mini project***

Atmega128A 를 활용한 세탁기 프로젝트


제작기간 : 2025-03-14 ~ 20215-03-17

***

1. [FSM](#FSM)

2. [회로도](#회로도)

3. [기능](#기능)

4. [설계](#설계)

***

## FSM

![fsm](https://github.com/user-attachments/assets/d39cf5f8-4c69-4398-b57d-e391732aede3)

## 회로도

![회로도](https://github.com/user-attachments/assets/bb044edc-c6ac-4aa4-83ea-58326f8df9b3)



***

## 기능

**step0** : RESET -> 세탁기 전원 OFF 모드 (FND dash 출력)

  > 버튼 3 : step0 -> step1

**step1** : 세탁 모드 선택 단계 -> FND에 "SELECT n" 이 출력된다.

  > 버튼 0 : 모드 숫자 up

  > 버튼 1 : 모드 숫자 down

  > 버튼 2 : 세탁 모드 확정 (step1 -> step2)

**step2** : 세탁 단계 -> 세탁 모드를 확정하면 자동으로 넘어온다.

미리 지정된 세탁시간에 맞추어 모터가 동작한다. 동시에 남은시간과 원형 애니메이션을 FND에 출력한다.

  > 버튼 0 : 일시정지

  > 버튼 1 : 다시시작

  > 버튼 2 : 세탁취소, 모드선택으로 다시 돌아감 (step2 -> step1)

**step3** : 세탁 종료 -> 세탁 시간이 다 되면 자동으로 넘어온다.

모터 동작을 중지하고, FND에 "DONE"을 출력한다.

  > 버튼 0 : 세탁 종료, 세탁기를 OFF한다 (step3 -> step0)

  > 버튼 1 : 동일 모드로 세탁기를 한번 더 동작한다 (step3 -> step2)

  > 버튼 2: 모드선택 단계로 되돌아간다 (step3 -> step1)

***

# 설계

Atmega128a에 존재하는 4개의 타이머

- **타이머 0** : 8비트, 1ms단위 시간측정 사용, delay 대신 사용한다.

  1ms마다 overflow 인터럽트 발생을 위해, 분주비 64, TCNT 초기화값 6으로 설정하였다.

- **타이머 1** : 16비트, 부저 음악재생 PWM 재생을 위해 사용

  버튼 동작음, 세탁 마무리음, 전원음 등 소리재생을 위해 사용함

- **타이머 2** : 초음파 센서를 위한 타이머

  초음파 센서로 거리값을 계산하기 위해 echo 펄스의 high 시간을 측정해야한다.

  8비트 타이머 분주비 64로 설정하여 카운트 값을 활용하였다.

  분주비가 256 이상으로 늘어나면 거리측정이 제대로 되지 않는 현상이 발생하였다.

- **타이머 3** : 모터 PWM 제어

  모터의 속도 조절을 위해 PWM신호를 생성하는 담당을 한다.

***


